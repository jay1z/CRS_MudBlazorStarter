@page "/Calendar"
@using CRS.Components.Pages.Calendar.Dialog
@using MudBlazor
@inject IDialogService DialogService

<MudContainer MaxWidth="MaxWidth.ExtraLarge">
    <MudCard>
        <MudCardHeader>
            <CardHeaderContent>
                <MudText Typo="Typo.h2" Class="fw-bold">Calendar</MudText>
            </CardHeaderContent>
            <CardHeaderActions>
                <MudButton Color="Color.Primary" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Add" OnClick="OpenCreateEventDialog">Add Event</MudButton>
                <MudIconButton Icon="@Icons.Material.Filled.Settings" Color="Color.Default" />
            </CardHeaderActions>
        </MudCardHeader>
        <MudCardContent>
            <MudCalendar Outlined=true CurrentDay="@currentDate" Items="events" />
        </MudCardContent>
    </MudCard>
</MudContainer>

@code {
    private DateTime currentDate = DateTime.Now;
    private List<CalendarItem> events = new();

    private async Task OpenCreateEventDialog() {
        var parameters = new DialogParameters {
                ["calendarEvent"] = new CalendarEvent() {
                    Title = "New Event",
                    Description = "Description",
                    Location = "Location",
                    Start = DateTime.Today,
                    End = DateTime.Today.AddHours(1),
                    IsAllDay = false,
                    Color = "primary"
                }
            };
        var dialog = await DialogService.ShowAsync<CreateEventDialog>("Create Event", parameters);
        var result = await dialog.Result;

        if (!result.Canceled) {
            events.Add(result.Data as CalendarItem);
        }
    }
}
