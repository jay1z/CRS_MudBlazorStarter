@model CRS.Models.Emails.PaymentReceiptEmail
@{
    Layout = "~/Components/EmailTemplates/_EmailLayout.cshtml";
    ViewData["PreheaderText"] = $"Payment received - {Model.AmountPaid:C} for Invoice #{Model.InvoiceNumber}";
}

<tr>
    <td style="padding: 40px 30px;">
        <!-- Success Header -->
        <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr>
                <td align="center" style="padding-bottom: 30px;">
                    <div style="width: 80px; height: 80px; background-color: #10b981; border-radius: 50%; display: inline-block; text-align: center; line-height: 80px;">
                        <span style="font-size: 40px; color: white;">✓</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td align="center" style="padding-bottom: 10px;">
                    <h1 style="margin: 0; font-size: 28px; color: #1a1a2e; font-weight: 700;">
                        Payment Received
                    </h1>
                </td>
            </tr>
            <tr>
                <td align="center" style="padding-bottom: 30px;">
                    <p style="margin: 0; font-size: 16px; color: #666;">
                        Thank you for your payment!
                    </p>
                </td>
            </tr>
        </table>

        <!-- Payment Details Box -->
        <table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color: #f8f9fa; border-radius: 12px; margin-bottom: 30px;">
            <tr>
                <td style="padding: 25px;">
                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                        <tr>
                            <td style="padding-bottom: 15px; border-bottom: 1px solid #e5e5e5;">
                                <span style="font-size: 14px; color: #666;">Amount Paid</span>
                                <div style="font-size: 32px; font-weight: 700; color: #10b981; margin-top: 5px;">
                                    @Model.AmountPaid.ToString("C")
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding-top: 15px;">
                                <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                    <tr>
                                        <td width="50%" style="padding: 8px 0;">
                                            <span style="font-size: 13px; color: #666;">Invoice Number</span>
                                            <div style="font-size: 15px; font-weight: 600; color: #1a1a2e;">
                                                @Model.InvoiceNumber
                                            </div>
                                        </td>
                                        <td width="50%" style="padding: 8px 0;">
                                            <span style="font-size: 13px; color: #666;">Payment Date</span>
                                            <div style="font-size: 15px; font-weight: 600; color: #1a1a2e;">
                                                @Model.PaymentDate.ToString("MMMM d, yyyy")
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="50%" style="padding: 8px 0;">
                                            <span style="font-size: 13px; color: #666;">Payment Method</span>
                                            <div style="font-size: 15px; font-weight: 600; color: #1a1a2e;">
                                                @(Model.PaymentMethod ?? "Credit Card")
                                            </div>
                                        </td>
                                        <td width="50%" style="padding: 8px 0;">
                                            <span style="font-size: 13px; color: #666;">Reference</span>
                                            <div style="font-size: 13px; font-weight: 500; color: #666; font-family: monospace;">
                                                @(Model.PaymentReference?.Substring(0, Math.Min(20, Model.PaymentReference?.Length ?? 0)))...
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <!-- Invoice Summary -->
        <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom: 30px;">
            <tr>
                <td style="padding-bottom: 15px;">
                    <h2 style="margin: 0; font-size: 18px; color: #1a1a2e; font-weight: 600;">
                        Invoice Summary
                    </h2>
                </td>
            </tr>
            <tr>
                <td>
                    <table width="100%" cellpadding="0" cellspacing="0" border="0" style="border: 1px solid #e5e5e5; border-radius: 8px;">
                        @if (!string.IsNullOrEmpty(Model.ClientName))
                        {
                            <tr>
                                <td style="padding: 12px 15px; border-bottom: 1px solid #e5e5e5; color: #666;">Client</td>
                                <td style="padding: 12px 15px; border-bottom: 1px solid #e5e5e5; text-align: right; font-weight: 600;">@Model.ClientName</td>
                            </tr>
                        }
                        @if (!string.IsNullOrEmpty(Model.Description))
                        {
                            <tr>
                                <td style="padding: 12px 15px; border-bottom: 1px solid #e5e5e5; color: #666;">Description</td>
                                <td style="padding: 12px 15px; border-bottom: 1px solid #e5e5e5; text-align: right;">@Model.Description</td>
                            </tr>
                        }
                        <tr>
                            <td style="padding: 12px 15px; border-bottom: 1px solid #e5e5e5; color: #666;">Invoice Total</td>
                            <td style="padding: 12px 15px; border-bottom: 1px solid #e5e5e5; text-align: right;">@Model.TotalAmount.ToString("C")</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px 15px; border-bottom: 1px solid #e5e5e5; color: #666;">This Payment</td>
                            <td style="padding: 12px 15px; border-bottom: 1px solid #e5e5e5; text-align: right; color: #10b981; font-weight: 600;">- @Model.AmountPaid.ToString("C")</td>
                        </tr>
                        <tr style="background-color: @(Model.IsFullyPaid ? "#ecfdf5" : "#fef3c7");">
                            <td style="padding: 12px 15px; font-weight: 600;">Balance Remaining</td>
                            <td style="padding: 12px 15px; text-align: right; font-weight: 700; font-size: 18px; color: @(Model.IsFullyPaid ? "#10b981" : "#f59e0b");">
                                @if (Model.IsFullyPaid)
                                {
                                    <span>$0.00 ✓ PAID IN FULL</span>
                                }
                                else
                                {
                                    @Model.BalanceRemaining.ToString("C")
                                }
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <!-- Action Buttons -->
        @if (!string.IsNullOrEmpty(Model.InvoiceUrl) || !string.IsNullOrEmpty(Model.DownloadPdfUrl))
        {
            <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom: 30px;">
                <tr>
                    <td align="center">
                        @if (!string.IsNullOrEmpty(Model.InvoiceUrl))
                        {
                            <a href="@Model.InvoiceUrl" 
                               style="display: inline-block; padding: 14px 28px; background-color: #6A3D9A; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; margin: 5px;">
                                View Invoice
                            </a>
                        }
                        @if (!string.IsNullOrEmpty(Model.DownloadPdfUrl))
                        {
                            <a href="@Model.DownloadPdfUrl" 
                               style="display: inline-block; padding: 14px 28px; background-color: #f8f9fa; color: #1a1a2e; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; border: 1px solid #e5e5e5; margin: 5px;">
                                Download PDF
                            </a>
                        }
                    </td>
                </tr>
            </table>
        }

        <!-- Footer Note -->
        <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr>
                <td style="padding: 20px; background-color: #f8f9fa; border-radius: 8px; text-align: center;">
                    <p style="margin: 0 0 10px 0; font-size: 14px; color: #666;">
                        This receipt was sent by <strong>@Model.TenantName</strong>
                    </p>
                    @if (!string.IsNullOrEmpty(Model.SupportEmail))
                    {
                        <p style="margin: 0; font-size: 13px; color: #888;">
                            Questions? Contact us at <a href="mailto:@Model.SupportEmail" style="color: #6A3D9A;">@Model.SupportEmail</a>
                        </p>
                    }
                </td>
            </tr>
        </table>
    </td>
</tr>
